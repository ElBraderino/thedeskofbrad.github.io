<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=author content="Brad Thornborrow ">
<meta name=description content="I was first introduced to the concept of the message of the day (MOTD) while working as a SunOS system administrator back in my university days. At our school, the systems used the Unix fortune command to display random messages and quotes on login. Being a bit nostalgic about these early days of the personal computer era, I decided to build a Message of the Day bot for Twitter. This would give me the pleasure of seeing my own custom messages of the day in my feed, and help me learn the ins and outs of the Twitter API.">
<meta name=keywords content=",twitter,python">
<meta name=robots content="noodp">
<meta name=theme-color content>
<link rel=canonical href=/posts/2018/07/build-a-twitter-message-of-the-day-motd-bot/>
<title>
Build a Twitter Message of the Day (MOTD) Bot ∣ Brad Thornborrow
</title>
<link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css>
<link rel=stylesheet href=/main.min.feca676bd2344243429c1be3db7ad89c169586b90da8dd758767ee900ec735ef.css>
<link rel=stylesheet type=text/css href=/css/custom.css>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<link rel=mask-icon href=/safari-pinned-tab.svg color>
<link rel="shortcut icon" href=/favicon.ico>
<meta name=msapplication-TileColor content>
<meta name=theme-color content>
<meta itemprop=name content="Build a Twitter Message of the Day (MOTD) Bot">
<meta itemprop=description content="I was first introduced to the concept of the message of the day (MOTD) while working as a SunOS system administrator back in my university days. At our school, the systems used the Unix fortune command to display random messages and quotes on login. Being a bit nostalgic about these early days of the personal computer era, I decided to build a Message of the Day bot for Twitter. This would give me the pleasure of seeing my own custom messages of the day in my feed, and help me learn the ins and outs of the Twitter API."><meta itemprop=datePublished content="2018-07-17T00:00:00+00:00">
<meta itemprop=dateModified content="2018-07-17T00:00:00+00:00">
<meta itemprop=wordCount content="1061"><meta itemprop=image content="/">
<meta itemprop=keywords content="twitter,python,"><meta property="og:title" content="Build a Twitter Message of the Day (MOTD) Bot">
<meta property="og:description" content="I was first introduced to the concept of the message of the day (MOTD) while working as a SunOS system administrator back in my university days. At our school, the systems used the Unix fortune command to display random messages and quotes on login. Being a bit nostalgic about these early days of the personal computer era, I decided to build a Message of the Day bot for Twitter. This would give me the pleasure of seeing my own custom messages of the day in my feed, and help me learn the ins and outs of the Twitter API.">
<meta property="og:type" content="article">
<meta property="og:url" content="/posts/2018/07/build-a-twitter-message-of-the-day-motd-bot/"><meta property="og:image" content="/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-07-17T00:00:00+00:00">
<meta property="article:modified_time" content="2018-07-17T00:00:00+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="/">
<meta name=twitter:title content="Build a Twitter Message of the Day (MOTD) Bot">
<meta name=twitter:description content="I was first introduced to the concept of the message of the day (MOTD) while working as a SunOS system administrator back in my university days. At our school, the systems used the Unix fortune command to display random messages and quotes on login. Being a bit nostalgic about these early days of the personal computer era, I decided to build a Message of the Day bot for Twitter. This would give me the pleasure of seeing my own custom messages of the day in my feed, and help me learn the ins and outs of the Twitter API.">
<meta property="article:published_time" content="2018-07-17 00:00:00 +0000 UTC">
</head>
<body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ style=text-decoration:none>
<div class=logo>
<span class=logo__mark>></span>
<span class=logo__text>hello</span>
<span class=logo__cursor style=background-color:#34fe2e>
</span>
</div>
</a>
<span class=header__right>
<nav class=menu>
<ul class=menu__inner><li><a href=/about/>About</a></li><li><a href=/contact/>Contact</a></li><li><a href=/posts/>Posts</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span>
</span>
</span>
</header>
<div class=content>
<main class=post>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
5 minutes
</p>
</div>
<article>
<h1 class=post-title>
<a href=/posts/2018/07/build-a-twitter-message-of-the-day-motd-bot/>Build a Twitter Message of the Day (MOTD) Bot</a>
</h1>
<div class=post-content>
<p>I was first introduced to the concept of the <a href=https://en.wikipedia.org/wiki/Motd_%28Unix%29 target=_blank>message of the day (MOTD)</a>
while working as a <strong>SunOS</strong> system administrator back in my university days. At our school, the systems used the Unix <code>fortune</code> command to display random messages and quotes on login. Being a bit nostalgic about these early days of the personal computer era, I decided to build a <em>Message of the Day</em> bot for Twitter. This would give me the pleasure of seeing my own custom messages of the day in my feed, and help me learn the ins and outs of the Twitter API. I have plans to develop more advanced Twitter bots in future, so now was as good a time as any to learn the new API.</p>
<p>As with my previous projects, I am running this Twitterbot using Python on one of my VMs running on AWS. I researched several libraries available for accessing Twitter in Python and decided to use the <a href=https://github.com/ryanmcgrath/twython target=_blank>Twython library</a>
to handle the API calls. The <strong>Twython</strong> library can be installed using the <strong>PIP</strong> package manager for Python, as shown below. Most newer versions of <strong>Linux</strong> include <strong>PIP</strong> by default, so the first command may not be necessary on some systems, but I included it just in case.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>sudo apt<span style=color:#f92672>-</span>get install python<span style=color:#f92672>-</span>pip
sudo pip install twython
</code></pre></div><p>Once <strong>Twython</strong> has been installed successfully, the next step is to create a Twitter account for the bot. Please note, you <strong>must</strong> assign a mobile phone number to this account, at least temporarily. Twitter will not allow apps to be created using an account which does not have a verified mobile phone number.</p>
<p>After creating your new Twitter bot account, go to <a href=https://apps.twitter.com target=_blank>https://apps.twitter.com/</a>
and click the <strong>Create New App</strong> button. When prompted, enter the following information:</p>
<ul>
<li>Name for the application</li>
<li>Description</li>
<li>Link to valid website (I used my site homepage)</li>
</ul>
<p>All other fields can be left blank. Check the boxed labelled <em>Yes, I have read and agree to the Twitter Developer Agreement</em> (assuming you read and agree), then click the button labelled <strong>Create your Twitter application</strong>. Once the app has been created, click on the <strong>Keys and Access Tokens</strong> tab to access your new app Consumer (API) keys.</p>
<img src=Twitter_App_Keys.jpg alt="Twitter App keys" class=left style=border-radius:5px;margin-left:1em;width:95%>
<p>You will also need <strong>Access Tokens</strong> to enable API access for your bot account. Click on the <strong>Regenerate Consumer Key and Secret</strong> link to generate these codes. Keep a copy of the <em>Consumer (API) Key</em>, <em>Consumer (API) Secret</em>, <em>Access Token</em> and <em>Access Token Secret</em> to be used later in your bot script. Also note, once this is done you can remove the mobile phone number assigned in <em>Account Settings</em> under the Twitter bot account. It is no longer required to create additional apps.</p>
<p>We&rsquo;re finally at the point where we can build and run our new Twitterbot. Here is a breakdown of the Python code for my <em>Message of the Day</em> bot. The first section includes standard declarations identifying any required Pythong libraries. It then opens a file named <strong>quotes.csv</strong> which is a simple comma delimited file of quotes I have collected over the years. The file contains two columns of information, the first column being the <code>quote</code>, the second column being the <code>citation</code> associated with the quote, as shown below.</p>
<table>
<thead>
<tr>
<th>quote</th>
<th>citation</th>
</tr>
</thead>
<tbody>
<tr>
<td>When opportunity knocks, bolt the door.</td>
<td>Grumpy Cat</td>
</tr>
<tr>
<td>The unexamined life is not worth living.</td>
<td>Socrates</td>
</tr>
</tbody>
</table>
<p>The file is read directly into a Python <em>dictionary</em> array for simple access in memory. Unfortunately, this includes the CSV file <em>header</em> row, which the last line of code deletes from the array to ensure it is not selected randomly in error.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/python</span>
<span style=color:#f92672>import</span> csv<span style=color:#f92672>,</span> random<span style=color:#f92672>,</span> sys
<span style=color:#f92672>from</span> twython <span style=color:#f92672>import</span> Twython, TwythonError

<span style=color:#75715e># Import quotes dictionary from csv file</span>
quotes <span style=color:#f92672>=</span> dict(csv<span style=color:#f92672>.</span>reader(open(<span style=color:#e6db74>&#34;/home/pi/etc/quotes.csv&#34;</span>, mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;r&#39;</span>)))
<span style=color:#75715e># Remove CSV header row from dictionary to avoid random selection</span>
<span style=color:#66d9ef>del</span> quotes[<span style=color:#e6db74>&#39;quote&#39;</span>]
</code></pre></div><p>The next section of code uses the Python <code>random.choice</code> function to select a random quote from the <em>quotes</em> array. The quote and citation are assembled in the variable <code>motd</code> using <code>utf-8</code> encoding which allows the <em>em dash</em> character to be included as part of the citation. Lastly, some quotes in the <strong>quotes.csv</strong> source file may be longer than the maximum allowed Tweet size (280 characters). To avoid this issue, the script uses a selection loop that repeats until a <em>Message of the Day (motd)</em> is selected which is less than 278 characters (just to play it safe).</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Select random quote</span>
<span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
	quote <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>choice(quotes<span style=color:#f92672>.</span>keys())
	cite <span style=color:#f92672>=</span> quotes[quote]
	motd <span style=color:#f92672>=</span> <span style=color:#e6db74>u</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>+</span> quote<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf8&#39;</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>u</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;\n</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>u</span><span style=color:#e6db74>&#34; </span><span style=color:#ae81ff>\u2014</span><span style=color:#e6db74> &#34;</span> <span style=color:#f92672>+</span> cite<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf8&#39;</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>u</span><span style=color:#e6db74>&#34;  #motd&#34;</span>

	<span style=color:#75715e># if less than max tweet size, break out of loop and tweet</span>
	<span style=color:#66d9ef>if</span> len(motd) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>278</span>:
		<span style=color:#66d9ef>break</span>
</code></pre></div><p>Once a quote has been selected and properly formatted, the script uses the <strong>Twython</strong> library to submit the Tweet via the Twitter API. For this to function, the <em>Consumer (API) Key</em>, <em>Consumer (API) Secret</em>, <em>Access Token</em> and <em>Access Token Secret</em> generated previously need to be inserted into the appropriate variables in the code below.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># Twitter authentication settings. Create a Twitter app at https://apps.twitter.com/ and</span>
<span style=color:#75715e># generate key, secret, etc, and insert them below.</span>
apiKey <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
apiSecret <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
accessToken <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
accessTokenSecret <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>

<span style=color:#75715e># Tweet Message of the Day</span>
<span style=color:#66d9ef>try</span>:
	twitter_api <span style=color:#f92672>=</span> Twython(apiKey,apiSecret,accessToken,accessTokenSecret)
	twitter_api<span style=color:#f92672>.</span>update_status(status <span style=color:#f92672>=</span> motd)
	print motd
<span style=color:#66d9ef>except</span> TwythonError <span style=color:#66d9ef>as</span> e:
	print(e)
</code></pre></div><p>On my server, I created this script with the filename <code>motd_bot.py</code>. I also enabled the <em>executable bit</em> on this file with the command <code>chmod +x motd_bot.py</code>. This allows running the script directly from the command line without calling Python first. After a few manual test runs to ensure it was working properly, I used the <code>crontab -e</code> command and added the following lines in the <code>crontab</code> file. This scheduled the script to run daily at 7:00am.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Tweet random MOTD at 7:00am</span>
<span style=color:#ae81ff>0</span> <span style=color:#ae81ff>7</span> * * * /home/bft/bin/motd_bot.py
</code></pre></div><p>One last item to note, as this script includes your Twitter API keys and secrets, it should only be stored and run from a properly secured system. In my example, the script is running on an Ubuntu Server VM which has been hardened following some of the steps from this <a href=https://gist.github.com/lokhman/cc716d2e2d373dd696b2d9264c0287a3 target=_blank>page</a>
on GitHub. Refer to the Twitter Developer <a href=https://developer.twitter.com/en/docs/basics/security-best-practices.html target=_blank>Security Best Practices</a>
page for more information.</p>
<p>As always, I hope you found this post useful, or at least entertaining. To contact me, please use the <a href=/contact>Contact</a>
page, or message me on <a href=https://twitter.com/bftsystems target=_blank>Twitter</a>
.</p>
<p>Thanks for reading.</p>
</div>
</article>
<hr>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=/tags/twitter/>twitter</a></span>
<span class=tag><a href=/tags/python/>python</a></span>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
1061 Words
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2018-07-17 12:00 AM
</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=/posts/2018/08/twitter-developer-platform-process-changes/>
<span class=button__icon>←</span>
<span class=button__text>Twitter Developer Platform process changes</span>
</a>
</span>
<span class="button next">
<a href=/posts/2018/07/what-happened-to-windows-update/>
<span class=button__text>What Happened to Windows Update?</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</main>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=footer__content>
<span>&copy; 2021
Brad Thornborrow
<a href=/motd title=motd><svg xmlns="http://www.w3.org/2000/svg" width="22" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left:0;margin-right:.25em"><rect x="3" y="4" width="18" height="15" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></a></span><span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a><a href="/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span>
</div>
</div>
<div class=footer__inner>
<div class=footer__content>
<span>Powered by <a href=http://gohugo.io>Hugo</a> & <a href=https://themes.gohugo.io/hugo-theme-hello-friend-ng/ rel=nofollow>Hello Friend NG</a></span>
</div>
</div>
</footer>
</div>
<script type=text/javascript src=/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>
</body>
</html>