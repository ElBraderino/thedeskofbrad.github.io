<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=author content="Brad Thornborrow ">
<meta name=description content="As I may have mentioned in previous posts, I run several small websites, both professionally and for personal interests. The majority are simple static websites, or low volume blogs which only expect a couple of updates in a week. With the various issues recently of crypto-miners and other exploits, I wanted a process in place to monitor for site issues, especially if the site changed unexpectedly. Of course, I could setup a trigger using IFTTT to monitor the sites and notify me in the event of changes, but as always, I wanted a “home-grown” solution I could customize.">
<meta name=keywords content=",hosting">
<meta name=robots content="noodp">
<meta name=theme-color content>
<link rel=canonical href=/posts/2018/06/simple-script-to-monitor-for-website-changes/>
<title>
Simple script to monitor for website changes ∣ Brad Thornborrow
</title>
<link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css>
<link rel=stylesheet href=/main.min.feca676bd2344243429c1be3db7ad89c169586b90da8dd758767ee900ec735ef.css>
<link rel=stylesheet type=text/css href=/css/custom.css>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<link rel=mask-icon href=/safari-pinned-tab.svg color>
<link rel="shortcut icon" href=/favicon.ico>
<meta name=msapplication-TileColor content>
<meta name=theme-color content>
<meta itemprop=name content="Simple script to monitor for website changes">
<meta itemprop=description content="As I may have mentioned in previous posts, I run several small websites, both professionally and for personal interests. The majority are simple static websites, or low volume blogs which only expect a couple of updates in a week. With the various issues recently of crypto-miners and other exploits, I wanted a process in place to monitor for site issues, especially if the site changed unexpectedly. Of course, I could setup a trigger using IFTTT to monitor the sites and notify me in the event of changes, but as always, I wanted a “home-grown” solution I could customize."><meta itemprop=datePublished content="2018-06-29T00:00:00+00:00">
<meta itemprop=dateModified content="2018-06-29T00:00:00+00:00">
<meta itemprop=wordCount content="439"><meta itemprop=image content="/">
<meta itemprop=keywords content="hosting,"><meta property="og:title" content="Simple script to monitor for website changes">
<meta property="og:description" content="As I may have mentioned in previous posts, I run several small websites, both professionally and for personal interests. The majority are simple static websites, or low volume blogs which only expect a couple of updates in a week. With the various issues recently of crypto-miners and other exploits, I wanted a process in place to monitor for site issues, especially if the site changed unexpectedly. Of course, I could setup a trigger using IFTTT to monitor the sites and notify me in the event of changes, but as always, I wanted a “home-grown” solution I could customize.">
<meta property="og:type" content="article">
<meta property="og:url" content="/posts/2018/06/simple-script-to-monitor-for-website-changes/"><meta property="og:image" content="/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-06-29T00:00:00+00:00">
<meta property="article:modified_time" content="2018-06-29T00:00:00+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="/">
<meta name=twitter:title content="Simple script to monitor for website changes">
<meta name=twitter:description content="As I may have mentioned in previous posts, I run several small websites, both professionally and for personal interests. The majority are simple static websites, or low volume blogs which only expect a couple of updates in a week. With the various issues recently of crypto-miners and other exploits, I wanted a process in place to monitor for site issues, especially if the site changed unexpectedly. Of course, I could setup a trigger using IFTTT to monitor the sites and notify me in the event of changes, but as always, I wanted a “home-grown” solution I could customize.">
<meta property="article:published_time" content="2018-06-29 00:00:00 +0000 UTC">
</head>
<body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ style=text-decoration:none>
<div class=logo>
<span class=logo__mark>></span>
<span class=logo__text>hello</span>
<span class=logo__cursor style=background-color:#34fe2e>
</span>
</div>
</a>
<span class=header__right>
<nav class=menu>
<ul class=menu__inner><li><a href=/about/>About</a></li><li><a href=/contact/>Contact</a></li><li><a href=/posts/>Posts</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span>
</span>
</span>
</header>
<div class=content>
<main class=post>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
3 minutes
</p>
</div>
<article>
<h1 class=post-title>
<a href=/posts/2018/06/simple-script-to-monitor-for-website-changes/>Simple script to monitor for website changes</a>
</h1>
<div class=post-content>
<p>As I may have mentioned in previous posts, I run several small websites, both professionally and for personal interests. The majority are simple static websites, or low volume blogs which only expect a couple of updates in a week. With the various issues recently of crypto-miners and other exploits, I wanted a process in place to monitor for site issues, especially if the site changed unexpectedly. Of course, I could setup a trigger using <a href=https://ifttt.com target=_blank>IFTTT</a>
to monitor the sites and notify me in the event of changes, but as always, I wanted a “home-grown” solution I could customize. As I already have several VMs in production performing various chores for me, I decided these would be perfect for the job.</p>
<p>For the sake of simplicity, I wrote a simple <strong>bash</strong> script which downloads the site home page using <strong>curl</strong> and compares if the page has changed from the previous run. This has the added benefit if the site is down, an error will be generated also causing an alert. If an issue is identified, the script sends an email notifying me to investigate.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#!/bin/bash
</span><span style=color:#75715e></span>                                                                                                                            
<span style=color:#75715e># Monitors a website for changes and sends notification</span>

DIRECTORY<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>dirname $0<span style=color:#e6db74>`</span>
CURRENT<span style=color:#f92672>=</span>$DIRECTORY/current.html
PREVIOUS<span style=color:#f92672>=</span>$DIRECTORY/previous.html
URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://thedeskofbrad.ca&#34;</span>

mv $CURRENT $PREVIOUS 2&gt; /dev/null
curl $URL -L --compressed -s &gt; $CURRENT
DIFF_OUTPUT<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>diff $CURRENT $PREVIOUS<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
<span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;0&#34;</span> !<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${#</span>DIFF_OUTPUT<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
  echo <span style=color:#e6db74>&#34;Site https://thedeskofbrad.ca has changed&#34;</span> | mail -s <span style=color:#e6db74>&#34;Site update report&#34;</span> email@domain.com
<span style=color:#66d9ef>fi</span>
</code></pre></div><p>As most of the sites being monitored are low volume sites, I decided to run this script every 8 hours using <strong>cron</strong>. To do this, I used the command <code>crontab -e</code> and added the following line for this purpose.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># m h  dom mon dow   command</span>
<span style=color:#ae81ff>0</span> */8 * * * /home/pi/bin/thedeskofbrad/monitor.sh
</code></pre></div><p>With this setup, if the site goes down or is compromised somehow, I will be notified by email within 8 hours at most. Depending on the importance of the site, I could decrease the interval to as low as once per minute, but 8 hours seemed enough for my purposes.</p>
<p>As this is a simple script which I developed specifically for my purposes, it has some obvious caveats. For example, if a page other than the home page is changed, it will not be reported. Also, if in future I add dynamic content such as <strong>Google Ads</strong>, this would break functionality, as the ads will change on each page request. If you decide to use this script for yourself, take these issues into consideration.</p>
<p>As always, I hope you found this post useful, or at least interesting. To contact me, please use the <a href=/contact>Contact</a>
page, or message me on <a href=https://twitter.com/bftsystems target=_blank>Twitter</a>
.</p>
<p>Thanks for reading.</p>
</div>
</article>
<hr>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=/tags/hosting/>hosting</a></span>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
439 Words
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2018-06-29 12:00 AM
</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=/posts/2018/07/using-powershell-to-find-inactive-users-in-ad-and-exchange/>
<span class=button__icon>←</span>
<span class=button__text>Using PowerShell to Find Inactive Users in AD and Exchange</span>
</a>
</span>
<span class="button next">
<a href=/posts/2018/06/moving-your-jekyll-site-from-github-pages-to-gitlab/>
<span class=button__text>Moving your Jekyll site from GitHub Pages to GitLab</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</main>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=footer__content>
<span>&copy; 2021
Brad Thornborrow
<a href=/motd title=motd><svg xmlns="http://www.w3.org/2000/svg" width="22" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left:0;margin-right:.25em"><rect x="3" y="4" width="18" height="15" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></a></span><span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a><a href="/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span>
</div>
</div>
<div class=footer__inner>
<div class=footer__content>
<span>Powered by <a href=http://gohugo.io>Hugo</a> & <a href=https://themes.gohugo.io/hugo-theme-hello-friend-ng/ rel=nofollow>Hello Friend NG</a></span>
</div>
</div>
</footer>
</div>
<script type=text/javascript src=/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>
</body>
</html>